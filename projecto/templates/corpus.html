{% extends 'basic_layout.html' %}

{% block body %}

<div>
  Behold the glorious auctores magni, now not only not names upon the gravestones of paper, but beautifully zombyfied and served e-style!
</div>
<div id="author-holder">
  {% if authors %}
    <div>
    {% for letter in g.ascii %}
    <a href="{%if not lettering%}#{{letter}}{%else%}{{url_for('frontend.show_all_authors', letter=letter)}}{%endif%}">{{letter}}</a>
    {% endfor %}
    </div>
{% for letter in authors.iterkeys() %}
<div><strong>{{letter}}</strong></div>
<div class="list-group" id="{{letter}}">
  {% for author in authors[letter]["items"] %}
  <a href="{{url_for('frontend.show_author', author_id=author.id)}}" class="list-group-item">
  {% if author.surname %}
  {{author.surname}}
  {% endif %}
  {% if author.name %}
  {{author.name}}
  {% endif %}
</a>
{% endfor %}
</div>
{% if lettering and not authors[letter]["finished"] %}
<button type="button" class="btn btn-default" id="load-more-authors">Load more authors</button>
{% endif %}
{% endfor %}
{% else %}

<h3>Nothing here yet!</h3>

{% endif %}
</div>

{% endblock body %}


{% block custom_links_js %}
<script src="{{ url_for('static', filename='js/myInfiniteLoadHelper.js') }}"></script>
{% endblock %}


{% block custom_js %}
{% if lettering %}
<script type="text/javascript">
  $(document).ready(function() {
  var authorsInfiniteLoadHelper = new InfiniteLoadHelper(
    2,
    $('.list-group').attr('id'),
    '{{url_for('frontend.show_author', author_id=0)}}'.slice(0, -2),
    'authors');

  $('#load-more-authors').click(function() {
    var button = $(this).clone(withDataAndEvents=true);
    var img = $('<img src="{{url_for('static', filename='gifs/corpus-loader.gif')}}"/>')
    $(this).replaceWith(img);
    authorsInfiniteLoadHelper.commenceLoad(
       '{{url_for('frontend.get_entities')}}',
       $('#author-holder'),
       $('.list-group'));
     img.replaceWith(button);
  });

  });
</script>
{% endif %}
{% endblock custom_js %}
